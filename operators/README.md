# Operators

This directory holds the operators that can be promoted and used in `gorgonnx`.
All the operators fulfils the [`Operator interface{}`](https://godoc.org/github.com/owulveryck/gorgonnx#Operator)

# Add a new operator 

If you want to add an operator, be sure to read its documentation from the [ONNX web page](https://github.com/onnx/onnx/blob/master/docs/Operators.md).

Then generate a skeleton of implementation and the unit tests with

```shell
./op.sh operator # operator is lowercase
```

This will generate two files:

* `operator_autogenerated_tests.go`
* `operator_todo.go`

## Tests

The file `operator_autogenerated_tests.go` is a pure go representation of the onnx tests related to the operator.
if you run

```
go test -run=Operator
``` 

you should see that all the tests are skipped because by default the `Init` and `Apply` methods return an `ErrNotImplemented` error.

## Implementation

a good practise is to rename the file from `_todo.go` to `_wip.go` until the implementation is ok.

### Init

You should start by implementing the `Init` method.
You can rely on the `UnmarshalAttributes` method of the `onnx-go` package.

Read the onnx documentation of the package and create an inner-type that will hold the values.

For example, if `Operator` expects an attribute named `myattribute` of type `int` with a defaut value of `42`, just create 

```go
type attributes struct {
    MyAttr int64 `attributeName:"myattribute"`
}
// Create an instance with default values
attr := attributes{
      MyAttr: 42,
}
err := onnx.UnmarshalAttributes(attrs, &attr)
```

### Apply

The apply method is straightforward. See the `Add` Operator for an example.
